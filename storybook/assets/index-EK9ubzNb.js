import{r as a,j as f}from"./iframe-CliXIuPX.js";import{S as E}from"./index-D12A7wYx.js";import{c as F}from"./lite-DaUVFjkg.js";import{u as L}from"./use-merge-refs-BvVliphZ.js";import{P as w}from"./paragraph-BCAN1PaO.js";const C=a.forwardRef(function({className:s,asChild:i,...o},n){const d=i?E:"p";return f.jsx(d,{className:F("ds-validation-message",s),"data-field":"validation",ref:n,...o})});function S(t){if(!t)return;const s=new Map,i=new Map,o=`:${Date.now().toString(36)}${Math.random().toString(36).slice(2,5)}`;let n=null,d="";const p=m=>{const b=[],x=[];for(const e of m)e.attributeName&&b.push(e.target??t),b.push(...e.addedNodes||[]),x.push(...e.removedNodes||[]);for(const e of b)M(e)&&(y(e)?s.set(e,e.htmlFor):e.hasAttribute("data-field")?s.set(e,e.id):j(e)&&!e.hidden&&(n=e,d=e.getAttribute("aria-describedby")||""));for(const e of x)M(e)&&(n===e&&(n=null),s.has(e)&&(v(e,y(e)?"for":"id",s.get(e)),s.delete(e)));const l=d?d.split(" "):[],r=(n==null?void 0:n.id)||o;i.clear();for(const[e,h]of s){const u=e.getAttribute("data-field");let g;if(u){const N=(i.get(u)||0)+1;i.set(u,N),g=`${r}:${u}:${N}`}else g=r;h||v(e,y(e)?"for":"id",g),l.includes(e.id)||(u==="validation"?l.unshift(e.id):u&&l.push(e.id))}v(n,"id",r),v(n,"aria-describedby",l.join(" ").trim())},c=D(p);return c.observe(t,{attributeFilter:["id","for","aria-describedby"],attributes:!0,childList:!0,subtree:!0}),p([{addedNodes:t.querySelectorAll("*")}]),c.takeRecords(),()=>c.disconnect()}const M=t=>t instanceof Element,y=t=>t instanceof HTMLLabelElement,j=t=>t instanceof HTMLElement&&"validity"in t&&!(t instanceof HTMLButtonElement),v=(t,s,i)=>i?t==null?void 0:t.setAttribute(s,i):t==null?void 0:t.removeAttribute(s);function D(t){const s=[],i=new MutationObserver(n=>{s.length||requestAnimationFrame(o),s.push(...n)}),o=()=>{t(s,i),s.length=0,i.takeRecords()};return i}const I=a.forwardRef(function({className:s,position:i,asChild:o,...n},d){const p=o?E:"div",c=a.useRef(null),m=L([c,d]);return a.useEffect(()=>S(c.current),[]),f.jsx(p,{className:F("ds-field",s),"data-position":i,ref:m,...n})}),O=a.forwardRef(function({className:s,...i},o){return f.jsx("div",{className:F("ds-field-affixes",s),ref:o,...i})}),T=a.forwardRef(function({className:s,...i},o){return f.jsx("span",{className:F("ds-field-affix",s),"aria-hidden":"true",ref:o,...i})}),R=(t,s)=>t.replace("%d",Math.abs(s).toString()),$=a.forwardRef(function({limit:s,under:i="%d tegn igjen",over:o="%d tegn for mye",...n},d){const[p,c]=a.useState(0),m=a.useRef(null),b=a.useRef(null),x=p>s,l=s-p;return a.useEffect(()=>{var u;const r=(u=b.current)==null?void 0:u.closest(".ds-field"),e=Array.from((r==null?void 0:r.getElementsByTagName("*"))||[]).find(j),h=({target:g})=>{j(g)&&c(g.value.length)};return e&&h({target:e}),m.current=e,r==null||r.addEventListener("input",h),()=>r==null?void 0:r.removeEventListener("input",h)},[]),a.useEffect(()=>{if(m.current){const r=m.current.value.length;c(e=>e===r?e:r)}}),f.jsxs(f.Fragment,{children:[f.jsx("div",{"data-field":"description",className:"ds-sr-only","aria-live":"polite",ref:b,children:x&&R(o,l)}),x?f.jsx(C,{ref:d,...n,children:R(o,l)}):f.jsx(w,{ref:d,...n,"data-field":"validation",children:R(i,l)})]})}),k=a.forwardRef(function(s,i){return f.jsx("div",{"data-field":"description",ref:i,...s})}),A=Object.assign(I,{Description:k,Affixes:O,Affix:T,Counter:$});A.Description.displayName="Field.Description";A.Affixes.displayName="Field.Affixes";A.Affix.displayName="Field.Affix";A.Counter.displayName="Field.Counter";export{A as F,C as V,k as a,O as b,T as c,$ as d};
