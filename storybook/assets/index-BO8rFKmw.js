import{r as o,j as c}from"./iframe-DYczXb5z.js";import{S as w}from"./index-Cj4nid3T.js";import{c as A}from"./lite-DaUVFjkg.js";import{u as T}from"./use-merge-refs-Cxzne_1X.js";import{P as S}from"./paragraph-RGBD6ej4.js";function k(n,t=50){const s=o.useRef(null);return o.useEffect(()=>()=>{s.current&&clearTimeout(s.current)},[]),(...i)=>{s.current&&clearTimeout(s.current),s.current=window.setTimeout(()=>{n(...i)},t)}}const D=o.forwardRef(function({className:t,asChild:s,...a},i){const d=s?w:"p";return c.jsx(d,{className:A("ds-validation-message",t),"data-field":"validation",ref:i,...a})});function I(n){if(!n)return;const t=new Map,s=new Map,a=`:${Date.now().toString(36)}${Math.random().toString(36).slice(2,5)}`;let i=null,d="";const p=b=>{const h=[],v=[];for(const e of b)e.attributeName&&h.push(e.target??n),h.push(...e.addedNodes||[]),v.push(...e.removedNodes||[]);for(const e of h)M(e)&&(N(e)?t.set(e,e.htmlFor):e.hasAttribute("data-field")?t.set(e,e.id):C(e)&&!e.hidden&&(i=e,d=e.getAttribute("aria-describedby")||""));for(const e of v)M(e)&&(i===e&&(i=null),t.has(e)&&(R(e,N(e)?"for":"id",t.get(e)),t.delete(e)));const l=d?d.split(" "):[],g=(i==null?void 0:i.id)||a;s.clear();for(const[e,x]of t){const m=e.getAttribute("data-field");let r;if(m){const u=(s.get(m)||0)+1;s.set(m,u),r=`${g}:${m}:${u}`}else r=g;x||R(e,N(e)?"for":"id",r),l.includes(e.id)||(m==="validation"?l.unshift(e.id):m&&l.push(e.id))}R(i,"id",g),R(i,"aria-describedby",l.join(" ").trim())},f=O(p);return f.observe(n,{attributeFilter:["id","for","aria-describedby"],attributes:!0,childList:!0,subtree:!0}),p([{addedNodes:n.querySelectorAll("*")}]),f.takeRecords(),()=>f.disconnect()}const M=n=>n instanceof Element,N=n=>n instanceof HTMLLabelElement,C=n=>n instanceof HTMLElement&&"validity"in n&&!(n instanceof HTMLButtonElement),R=(n,t,s)=>s?n==null?void 0:n.setAttribute(t,s):n==null?void 0:n.removeAttribute(t);function O(n){const t=[],s=new MutationObserver(i=>{t.length||requestAnimationFrame(a),t.push(...i)}),a=()=>{n(t,s),t.length=0,s.takeRecords()};return s}const $=o.forwardRef(function({className:t,position:s,asChild:a,...i},d){const p=a?w:"div",f=o.useRef(null),b=T([f,d]);return o.useEffect(()=>I(f.current),[]),c.jsx(p,{className:A("ds-field",t),"data-position":s,ref:b,...i})}),q=o.forwardRef(function({className:t,...s},a){return c.jsx("div",{className:A("ds-field-affixes",t),ref:a,...s})}),H=o.forwardRef(function({className:t,...s},a){return c.jsx("span",{className:A("ds-field-affix",t),"aria-hidden":"true",ref:a,...s})}),F=(n,t)=>n.replace("%d",Math.abs(t).toString()),V=o.forwardRef(function({limit:t,under:s="%d tegn igjen",over:a="%d tegn for mye",hint:i="Maks %d tegn tillatt.",...d},p){const[f,b]=o.useState(0),[h,v]=o.useState(""),l=o.useRef(null),g=o.useRef(null),e=f>t,x=t-f,m=k(r=>v(r),1200);return o.useEffect(()=>{var E;const r=(E=g.current)==null?void 0:E.closest(".ds-field"),u=Array.from((r==null?void 0:r.getElementsByTagName("*"))||[]).find(C),j=({target:L})=>{C(L)&&b(L.value.length)};return u&&j({target:u}),l.current=u,r==null||r.addEventListener("input",j),()=>r==null?void 0:r.removeEventListener("input",j)},[]),o.useEffect(()=>{if(l.current){const r=l.current.value.length;b(u=>u===r?u:r)}}),o.useEffect(()=>{m(F(e?a:s,x))},[f,t,a,s,e,x]),c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"ds-sr-only","aria-live":"polite",ref:g,children:h}),e?c.jsx(D,{ref:p,...d,"aria-hidden":"true","data-field":null,children:F(a,x)}):c.jsx(S,{ref:p,...d,"aria-hidden":"true",children:F(s,x)}),c.jsx("div",{className:"ds-sr-only","aria-hidden":"true","data-field":"description",children:F(i,t)})]})}),B=o.forwardRef(function(t,s){return c.jsx("div",{"data-field":"description",ref:s,...t})}),y=Object.assign($,{Description:B,Affixes:q,Affix:H,Counter:V});y.Description.displayName="Field.Description";y.Affixes.displayName="Field.Affixes";y.Affix.displayName="Field.Affix";y.Counter.displayName="Field.Counter";export{y as F,D as V,B as a,q as b,H as c,V as d};
