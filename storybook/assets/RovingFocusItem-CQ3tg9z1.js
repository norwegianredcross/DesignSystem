import{j as I}from"./jsx-runtime-D_zvdyIk.js";import{u as F}from"./floating-ui.react-VFS6-CKd.js";import{S}from"./index-Cb-ENzfG.js";import{r as l}from"./index-D4lIrffr.js";const D=l.createContext({elements:{current:new Map},getOrderedItems:()=>[],setFocusableValue:()=>{},onShiftTab:()=>{},focusableValue:null,orientation:"horizontal"}),P=l.forwardRef(({activeValue:e,asChild:a,orientation:t="horizontal",onBlur:c,onFocus:d,...f},x)=>{const n=a?S:"div",[r,s]=l.useState(null),[w,u]=l.useState(!1),o=l.useRef(new Map),i=l.useRef(null),h=F([x,i]),k=()=>{if(!i.current)return[];const g=Array.from(i.current.querySelectorAll("[data-roving-tabindex-item]"));return Array.from(o.current).sort((m,b)=>g.indexOf(m[1])-g.indexOf(b[1])).map(([m,b])=>({value:m,element:b}))};return l.useEffect(()=>{s(e??null)},[e]),I.jsx(D.Provider,{value:{elements:o,getOrderedItems:k,focusableValue:r,setFocusableValue:s,onShiftTab:()=>{u(!0)},orientation:t},children:I.jsx(n,{...f,tabIndex:w?-1:0,onBlur:g=>{c==null||c(g),u(!1),s(e??null)},onFocus:g=>{var b,A,v;if(d==null||d(g),g.target!==g.currentTarget)return;const m=k();m.length!==0&&(r!=null?(b=o.current.get(r))==null||b.focus():e!=null?(A=o.current.get(e))==null||A.focus():(v=m.at(0))==null||v.element.focus())},ref:h})})}),O=e=>{const{elements:a,getOrderedItems:t,setFocusableValue:c,focusableValue:d,onShiftTab:f,orientation:x}=l.useContext(D);return{getOrderedItems:t,isFocusable:d===e,orientation:x,getRovingProps:n=>({...n,ref:r=>{r?a.current.set(e,r):a.current.delete(e)},onKeyDown:r=>{var s;if((s=n==null?void 0:n.onKeyDown)==null||s.call(n,r),r.shiftKey&&r.key==="Tab"){f();return}},onFocus:r=>{var s;(s=n==null?void 0:n.onFocus)==null||s.call(n,r),c(e)},"data-roving-tabindex-item":!0,tabIndex:d===e?0:-1})}};function y(e,a){const t=e.findIndex(c=>c.value===a);return e.at(t===e.length-1?0:t+1)}function R(e,a){const t=e.findIndex(c=>c.value===a);return e.at(t===0?-1:t-1)}const V=l.forwardRef(({value:e,asChild:a,...t},c)=>{const d=a?S:"div",f=e??(typeof t.children=="string"?t.children:""),{getOrderedItems:x,getRovingProps:n,orientation:r}=O(f),s=n({onKeyDown:u=>{var h;(h=t==null?void 0:t.onKeyDown)==null||h.call(t,u);const o=x();let i;switch(r){case"horizontal":u.key==="ArrowRight"&&(i=y(o,f)),u.key==="ArrowLeft"&&(i=R(o,f));break;case"vertical":u.key==="ArrowDown"&&(i=y(o,f)),u.key==="ArrowUp"&&(i=R(o,f));break;case"ambiguous":["ArrowRight","ArrowDown"].includes(u.key)&&(i=y(o,f)),["ArrowLeft","ArrowUp"].includes(u.key)&&(i=R(o,f))}u.key==="Home"&&(i=o[0]),u.key==="End"&&(i=o[o.length-1]),i&&(u.preventDefault(),i.element.focus())}}),w=F([c,s.ref]);return I.jsx(d,{...t,...s,ref:w,children:t.children})});export{P as R,V as a};
