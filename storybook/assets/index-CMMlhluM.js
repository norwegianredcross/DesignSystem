import{j as f}from"./jsx-runtime-D_zvdyIk.js";import{u as N}from"./floating-ui.react-VFS6-CKd.js";import{c as v}from"./lite-DaUVFjkg.js";import{r as a}from"./index-D4lIrffr.js";import{S as M}from"./index-Cb-ENzfG.js";import{P as E}from"./Paragraph-CJciD5B6.js";const L=a.forwardRef(function({className:s,asChild:n,...i},o){const d=n?M:"p";return f.jsx(d,{className:v("ds-validation-message",s),"data-field":"validation",ref:o,...i})});function w(t){if(!t)return;const s=new Map,n=`:${Date.now().toString(36)}${Math.random().toString(36).slice(2,5)}`;let i=null,o="";const d=x=>{const m=[],p=[];for(const e of x)e.attributeName&&m.push(e.target??t),m.push(...e.addedNodes||[]),p.push(...e.removedNodes||[]);for(const e of m)j(e)&&(A(e)?s.set(e,e.htmlFor):e.hasAttribute("data-field")?s.set(e,e.id):R(e)&&(i=e,o=e.getAttribute("aria-describedby")||""));for(const e of p)j(e)&&(i===e&&(i=null),s.has(e)&&(h(e,A(e)?"for":"id",s.get(e)),s.delete(e)));const u=[o],r=(i==null?void 0:i.id)||n;for(const[e,b]of s){const l=e.getAttribute("data-field"),g=l?`${r}:${l}`:r;b||h(e,A(e)?"for":"id",g),l==="validation"?u.unshift(e.id):l&&u.push(e.id)}h(i,"id",r),h(i,"aria-describedby",u.join(" ").trim())},c=C(d);return c.observe(t,{attributeFilter:["id","for","aria-describedby"],attributes:!0,childList:!0,subtree:!0}),d([{addedNodes:t.querySelectorAll("*")}]),c.takeRecords(),()=>c.disconnect()}const j=t=>t instanceof Element,A=t=>t instanceof HTMLLabelElement,R=t=>t instanceof HTMLElement&&"validity"in t&&!(t instanceof HTMLButtonElement),h=(t,s,n)=>n?t==null?void 0:t.setAttribute(s,n):t==null?void 0:t.removeAttribute(s);function C(t){const s=[],n=new MutationObserver(o=>{s.length||requestAnimationFrame(i),s.push(...o)}),i=()=>{t(s,n),s.length=0,n.takeRecords()};return n}const S=a.forwardRef(function({className:s,position:n,...i},o){const d=a.useRef(null),c=N([d,o]);return a.useEffect(()=>w(d.current),[]),f.jsx("div",{className:v("ds-field",s),"data-position":n,ref:c,...i})}),D=a.forwardRef(function({className:s,...n},i){return f.jsx("div",{className:v("ds-field-affixes",s),ref:i,...n})}),O=a.forwardRef(function({className:s,...n},i){return f.jsx("span",{className:v("ds-field-affix",s),"aria-hidden":"true",ref:i,...n})}),y=(t,s)=>t.replace("%d",Math.abs(s).toString()),T=a.forwardRef(function({limit:s,under:n="%d tegn igjen",over:i="%d tegn for mye",...o},d){const[c,x]=a.useState(0),m=a.useRef(null),p=c>s,u=s-c;return a.useEffect(()=>{var l;const r=(l=m.current)==null?void 0:l.closest(".ds-field"),e=Array.from((r==null?void 0:r.getElementsByTagName("*"))||[]).find(R),b=({target:g})=>{R(g)&&x(g.value.length)};return e&&b({target:e}),r==null||r.addEventListener("input",b),()=>r==null?void 0:r.removeEventListener("input",b)},[x]),f.jsxs(f.Fragment,{children:[f.jsx("div",{"data-field":"description",className:"ds-sr-only","aria-live":"polite",ref:m,children:p&&y(i,u)}),p?f.jsx(L,{ref:d,...o,children:y(i,u)}):f.jsx(E,{ref:d,...o,"data-field":"validation",children:y(n,u)})]})}),$=a.forwardRef(function(s,n){return f.jsx("div",{"data-field":"description",ref:n,...s})}),F=Object.assign(S,{Description:$,Affixes:D,Affix:O,Counter:T});F.Description.displayName="Field.Description";F.Affixes.displayName="Field.Affixes";F.Affix.displayName="Field.Affix";F.Counter.displayName="Field.Counter";export{F,L as V,$ as a,T as b,D as c,O as d};
