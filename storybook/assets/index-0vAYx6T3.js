import{r as a,j as f}from"./iframe-DzHbI1Bv.js";import{S as w}from"./index-B-a3BGFc.js";import{c as v}from"./lite-DaUVFjkg.js";import{u as C}from"./use-merge-refs-B76l2vM2.js";import{P as E}from"./paragraph-DYKqBuhr.js";const L=a.forwardRef(function({className:s,asChild:i,...r},n){const d=i?w:"p";return f.jsx(d,{className:v("ds-validation-message",s),"data-field":"validation",ref:n,...r})});function S(t){if(!t)return;const s=new Map,i=new Map,r=`:${Date.now().toString(36)}${Math.random().toString(36).slice(2,5)}`;let n=null,d="";const l=p=>{const m=[],b=[];for(const e of p)e.attributeName&&m.push(e.target??t),m.push(...e.addedNodes||[]),b.push(...e.removedNodes||[]);for(const e of m)M(e)&&(y(e)?s.set(e,e.htmlFor):e.hasAttribute("data-field")?s.set(e,e.id):j(e)&&!e.hidden&&(n=e,d=e.getAttribute("aria-describedby")||""));for(const e of b)M(e)&&(n===e&&(n=null),s.has(e)&&(h(e,y(e)?"for":"id",s.get(e)),s.delete(e)));const o=d?d.split(" "):[],x=(n==null?void 0:n.id)||r;i.clear();for(const[e,g]of s){const u=e.getAttribute("data-field");let A;if(u){const N=(i.get(u)||0)+1;i.set(u,N),A=`${x}:${u}:${N}`}else A=x;g||h(e,y(e)?"for":"id",A),o.includes(e.id)||(u==="validation"?o.unshift(e.id):u&&o.push(e.id))}h(n,"id",x),h(n,"aria-describedby",o.join(" ").trim())},c=D(l);return c.observe(t,{attributeFilter:["id","for","aria-describedby"],attributes:!0,childList:!0,subtree:!0}),l([{addedNodes:t.querySelectorAll("*")}]),c.takeRecords(),()=>c.disconnect()}const M=t=>t instanceof Element,y=t=>t instanceof HTMLLabelElement,j=t=>t instanceof HTMLElement&&"validity"in t&&!(t instanceof HTMLButtonElement),h=(t,s,i)=>i?t==null?void 0:t.setAttribute(s,i):t==null?void 0:t.removeAttribute(s);function D(t){const s=[],i=new MutationObserver(n=>{s.length||requestAnimationFrame(r),s.push(...n)}),r=()=>{t(s,i),s.length=0,i.takeRecords()};return i}const O=a.forwardRef(function({className:s,position:i,asChild:r,...n},d){const l=r?w:"div",c=a.useRef(null),p=C([c,d]);return a.useEffect(()=>S(c.current),[]),f.jsx(l,{className:v("ds-field",s),"data-position":i,ref:p,...n})}),T=a.forwardRef(function({className:s,...i},r){return f.jsx("div",{className:v("ds-field-affixes",s),ref:r,...i})}),$=a.forwardRef(function({className:s,...i},r){return f.jsx("span",{className:v("ds-field-affix",s),"aria-hidden":"true",ref:r,...i})}),R=(t,s)=>t.replace("%d",Math.abs(s).toString()),I=a.forwardRef(function({limit:s,under:i="%d tegn igjen",over:r="%d tegn for mye",...n},d){const[l,c]=a.useState(0),p=a.useRef(null),m=l>s,b=s-l;return a.useEffect(()=>{var g;const o=(g=p.current)==null?void 0:g.closest(".ds-field"),x=Array.from((o==null?void 0:o.getElementsByTagName("*"))||[]).find(j),e=({target:u})=>{j(u)&&c(u.value.length)};return x&&e({target:x}),o==null||o.addEventListener("input",e),()=>o==null?void 0:o.removeEventListener("input",e)},[c]),f.jsxs(f.Fragment,{children:[f.jsx("div",{"data-field":"description",className:"ds-sr-only","aria-live":"polite",ref:p,children:m&&R(r,b)}),m?f.jsx(L,{ref:d,...n,children:R(r,b)}):f.jsx(E,{ref:d,...n,"data-field":"validation",children:R(i,b)})]})}),k=a.forwardRef(function(s,i){return f.jsx("div",{"data-field":"description",ref:i,...s})}),F=Object.assign(O,{Description:k,Affixes:T,Affix:$,Counter:I});F.Description.displayName="Field.Description";F.Affixes.displayName="Field.Affixes";F.Affix.displayName="Field.Affix";F.Counter.displayName="Field.Counter";export{F,L as V,k as a,I as b,T as c,$ as d};
